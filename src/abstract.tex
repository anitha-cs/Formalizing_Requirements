Formal methods have been enormously useful in verifying complex system requirements. However, their success depends on precisely formalizing {\em what} needs to be verified and thoroughly understanding {\em how} it is verified. While the advances in formal methods has given rise to sophisticated techniques and tools, there is a lack of awareness and methodological guidance in using these techniques effectively, that often makes their use difficult and the results of their application leading to overconfidence into the correctness of the fielded system in its intended environment.

In this paper, we report on using formal methods to verify a complex infusion pump system.  While the effort was very successful and has led to a complete verification of a hierarchically composed software architecture (down to the implementation of software components in Simulink), it was not without challenges that we believe are not adequately presented in the research literature. In our experience, we found that (a) precisely identifying the contextual information for requirements when formalizing requirements from traditionally structured requirements document is a non-trivial task, (b) some incorrect guidance exists on ``flowing down'' system requirements to lower levels of abstraction, (c) inexperience with tools can lead to "proofs" based on faulty premises, and (d) inadequate mitigation of risks when using multiple analysis tools can lead to misplaced confidence about the system. We then explain our approach to identify, mitigate and address such concerns.

%The benefits of formal techniques at their intersection with requirements engineering is tricky to access. Formal methods have been enormously useful in verifying complex system requirements. However, their success depends on precisely formalizing ``what" needs to be verified and thoroughly understanding ``how" it is verified. While the advances in this field has given rise to sophisticated techniques and tools, there is a lack of awareness and guidance in appropriately using them, that often makes their use painful and results misleading.
%
%In this paper, we report on the challenges and non-obvious nuances in using formal methods to verify the requirements of hierarchically developed complex systems that, we believe, are recurrent concerns yet inadequately addressed  in the formal requirements analysis community. In our experience, we found that (a) precisely identifying the contextual information for requirements when formalizing requirements from traditionally structured requirements document is a non-trivial task, (b) failure to recognize the subtility between requirements when formalizing them at various levels of abstraction leads to believable, but highly misleading verification, (c) lapse in detecting the fallibility of the tools could leads to incorrect “proofs” about systems, and (d) inadequate mitigation of risks associated with different tools usage could lead to misplaced confidence about the system. In the sequel, we explain our approach to identify, mitigate and address such concerns. We believe that these lessons learned would prove instructional for practitioners involved in similar efforts.

%
%
%verifying requirements of a medical device system. We found that formalizing requirements from traditionally structured requirements document to verify a model of the system is particularly challenging due to the
%
%Formalizing modal requirements that typical to most control systems from traditionally structured requirements document, formalizing requirements at different levels of system hierarchy, recognizing the fallibility of the tools that lead to incorrect “proofs” about systems, and understanding the risks associated with using different verification tools, even when they share the same semantics.
%
%We found that formalizing modal requirements of system from traditionally structured requirements documents,
%
%In our experience of formally verifying a medical device system, we encounter
%
%the practical challenges and pitfalls in (a) formalizing modal requirements of system from traditionally structured requirements documents, (b) formalizing requirements at different levels of system hierarchy, (c) recognizing the fallibility of the tools that lead to incorrect “proofs” about systems, and (d) understanding the risks associated with using different verification tools, even when they share the same semantics. In the sequel, we explain our approach to identify, mitigate and address such concerns. We believe that these challenges and lessons learned would serve as guidance or best practices for practitioners involved in similar efforts.


\iffalse


Formal methods has been enormously useful in verifying complex
system requirements early in their development. However, the difficulty in us-
ing formal techniques lies in precisely formalizing “what” needs to be verified
and thoroughly understanding “how” it is verified, rather than the action of ver-
ification itself. While the advances in this field has given rise to sophisticated
techniques and tools, there is a lack of guidance in using them precisely that
makes their use painful and leads to misplaced confidence about the system.
In this paper we report on some of the challenges and non-obvious nuances in
using formal methods to verify the requirements of hierarchically constructed
complex systems that, we believe, has not received adequate attention in the veri-
fication community. In particular, we focus on the practical challenges and pitfalls
in formalizing requirements at different levels of system hierarchy, recognizing
the fallibility of the tools that lead to incorrect “proofs” about systems, and un-
derstanding the risks associated with using different verification tools, even when
they share the same semantics. In the sequel, we explain our approach to mitigate
and address such concerns. While we illustrate these concerns using a medical
device example, we believe that these challenges and lessons learned are relevant
and useful for practitioners involved in similar efforts.

Challenges/Pitfalls are:

What is the issue:

1. Given system requirements, defining correct software requirements.  A common (mis)practice is flow system requirements into software requirements by

multiple ``layers'' in a hierarchically composed system.


1. There are challenging issues in mapping requirements between layers in hierarchically composed systems.

- At the system/software boundary, a common (mis)practice is to formalize the system requirements as software requirements by changing variable names. System Requirements describe a range of acceptable behaviours (relational), whereas software requirements should almost always be functional. Failing to capture the difference results in verification errors.

- At various software layers, it is likely that small variations of requirements will be "flowed down" (sometimes just by changing variable names).  Requirements changes at one layer "ripple through" these layers requiring non-trivial effort to change.

2. Specifying operational requirements in natural language is (deceptively) easy; however, it is likely that exceptional conditions are not caught.  When starting from natural language requirements then later formalizing them, the natural language requirements often do not provide enough information to determine proper system behavior in these cases.  Thus, domain experts must be involved in the formalization process - there is no systematic process to "fill in" these details.

3. Formalizing prioritized system behaviors (if C and not X then Y) can be challenging. Similar to operational requirements, one needs to systematically formalize properties to verify the independent effect of each requirement. This easily becomes too complex to manage.

4. Using formal tools with cursory knowledge about how the tools work can be dangerous.
(We could expand on the discussion from the NFM paper here)

5. Tool boundaries are very problematic; even if "same" semantics, the translation of properties between tools
  leads to lots of errors.

\fi 